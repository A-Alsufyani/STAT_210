setwd("C:/Users/ksa4e/Desktop/KAUST/STAT_210/Exam 2")
data_1 <- read.csv("XM225F_q1.csv")
head(data_1)
data_2 <- read.csv("XM225F_q2.csv")
head(data_2)
data_3 <- read.csv("XM225F_q3.csv")
head(data_3)
levels(data_2)
str(data_2)
data_2$fertilizer  <- as.factor(data_2$fertilizer)
data_3 <- read.csv("XM225F_q3.csv")
str(data_2)
data_1 <- read.csv("XM225F_q1.csv")
head(data_1)
Q1data <- data.frame()
Q1data <- data.frame(data_1[, -2 -3])
Q1data <- data.frame(data_1[, 1])
Q1data <- data.frame(data_1[, 1], data_1[,2])
Q1data <- data.frame(data_1[, age], data_1[,2])
Q1data <- data.frame(data_1[, 0], data_1[,2])
Q1data <- data.frame(data_1[, 0], data_1[, 2])
Q1data <- data.frame(data_1[, 1], data_1[, 2])
Q1data <- data.frame(data_1 [, 6],data_1[, 8], data_1[, 9])
str(Q1data)
Q1data <- data_1[, c("mass", "age", "diabetes")]
str(Q1data)
sum(is.na(Q1data[, "mass"]))
sum(is.na(Q1data[, "mass"])) # check if mass has any empty values
sum(is.na(Q1data[, "age"]))
sum(is.na(Q1data[, "mass"])) # check if mass has any empty values
sum(is.na(Q1data[, "age"]))  # check if age has any empty values.
q
q <- quantile(df1$R_age, probs = seq(0, 1, length.out = 6))
#(b) Create a new ordered factor in Q1data with name bmi according to the following rules: If mass is less
#than or equal to 25 the value of bmi is normal; if mass is over 25 and up to 30 the value of bmi is
#overweight, and if mass is above 30 the value is obese.
bmi_cutoff_names <- c("Normal", "Overweight", "Obese")
bmi_cutoff_values <- c(25, 30)
Q1data$bmi <- cut(Q1data$mass,
breaks = bmi_cutoff_values,
labels = bmi_cutoff_names,
ordered = TRUE)
bmi_cutoff_values <- c(25, 30, 40)
Q1data$bmi <- cut(Q1data$mass,
breaks = bmi_cutoff_values,
labels = bmi_cutoff_names,
ordered = TRUE)
bmi_cutoff_values <- c(25, 30, 40, 50)
Q1data$bmi <- cut(Q1data$mass,
breaks = bmi_cutoff_values,
labels = bmi_cutoff_names,
ordered = TRUE)
data_2 <- read.csv("XM225F_q2.csv")
bmi_cutoff_values <- c(0, 25, 30, 300)
Q1data$bmi <- cut(Q1data$mass,
breaks = bmi_cutoff_values,
labels = bmi_cutoff_names,
ordered = TRUE)
str(Q1data)
str(Q1data$bmi)
head(Q1data$bmi)
bmi_cutoff_values <- c(0, 25, 30, 1000) # from 0 to 25 is normal, 25 to 30 is overweight, 30 and above is obese.
table1 <- table(Q1data$bmi, Q1data$diabetes)
(table1 <- table(Q1data$bmi, Q1data$diabetes))
mosaicplot(table1,
main = "BMI vs diabetes",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("lightblue", "lightgreen", "pink", "orange", "violet"))
mosaicplot(table1,
main = "BMI vs diabetes",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("blue", "red"))
chi_bmi_diabetes <- chisq.test(table1)
(chi_bmi_diabetes <- chisq.test(table1))
#we then check the expected cell count to check the reliability of the test
chi_age_happy$expected
#we then check the expected cell count to check the reliability of the test
chi_bmi_diabetes$expected
sum(chi_age_happy$expected < 5)
sum(chi_bmi_diabetes$expected < 5)
(q <- quantile(Q1data$age, probs = seq(0, 1, length.out = 5)))
(q <- quantile(Q1data$age, probs = seq(0, 1, length.out = 4)))
Q1data$fage <- cut(Q1data$mass,
breaks = q,
labels = c("a1","a2","a3",'a4'),
ordered = TRUE)
Q1data$fage <- cut(Q1data$age,
breaks = q,
labels = c("a1","a2","a3",'a4'),
ordered = TRUE)
(q <- quantile(Q1data$age, probs = seq(0, 1, length.out = 4)))
Q1data$fage <- cut(Q1data$age,
breaks = q,
labels = c("a1","a2","a3",'a4'),
ordered = TRUE)
(q <- quantile(Q1data$age, probs = seq(0, 1, length.out = 5)))
Q1data$fage <- cut(Q1data$age,
breaks = q,
labels = c("a1","a2","a3",'a4'),
ordered = TRUE)
q1data$fage
Q1data$fage
(q <- quantile(Q1data$age, probs = seq(0, 1, length.out = 5))) #split into
(table2 <- table(Q1data$fage, Q1data$bmi)) # create a contingency table for bmi and diabetes
(table2 <- table(Q1data$bmi, Q1data$fage)) # create a contingency table for bmi and diabetes
mosaicplot(table2,
main = "BMI vs diabetes",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("blue", "red"))
mosaicplot(table2,
main = "BMI vs diabetes",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("green", "yellow", "blue", "red"))
mosaicplot(table2,
main = "Fage vs BMI",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("green", "yellow", "blue", "red"))
mosaicplot(table2,
main = "Fage vs BMI",
xlab = "BMI Group (bmi)",
ylab = "Age Group (fage)",
color = c("green", "yellow", "blue", "red"))
#make the new factor "fage" using the equal split sized of ages
Q1data$fage <- cut(Q1data$age,
breaks = q,
labels = c("a1","a2","a3",'a4'),
ordered = TRUE)
(table2 <- table(Q1data$bmi, Q1data$fage)) # create a contingency table for bmi and diabetes
mosaicplot(table2,
main = "Fage vs BMI",
xlab = "BMI Group (bmi)",
ylab = "Age Group (fage)",
color = c("green", "yellow", "blue", "red"))
(chi_fage_ <- chisq.test(table2))
#draw the mosaic plot.
mosaicplot(table1,
main = "BMI vs diabetes",
xlab = "Age Group (R_a)",
ylab = "Happiness (R_h)",
color = c("blue", "red"))
#draw the mosaic plot.
mosaicplot(table1,
main = "BMI vs diabetes",
xlab = "BMI Group (bmi)",
ylab = "Diabetes Result (diabetes)",
color = c("blue", "red"))
(chi_fage_bmi <- chisq.test(table2))
#we then check the expected cell count to check the reliability of the test
chi_fage_bmi$expected
sum(chi_bmi_diabetes$expected < 5)
(chi_fage_bmi <- chisq.test(table2))
#we then check the expected cell count to check the reliability of the test
chi_fage_bmi$expected
sum(chi_bmi_diabetes$expected < 5)
data_2 <- read.csv("XM225F_q2.csv")
head(data_2)
str(data_2)
data_2$fertilizer  <- as.factor(data_2$fertilizer)
str(data_2)
Q2data <- read.csv("XM225F_q2.csv")
head(Q2data)
str(Q2data)
Q2data$fertilizer  <- as.factor(Q2data$fertilizer)
str(Q2data)
model_1 <- lm(yield ~ rainfall)
model_1 <- lm(yield ~ rainfall, data = Q2data)
plot(yield, rainfall, data = Q2data,
main = "Weight vs Height of American Women (30–39)",
xlab = "Height (inches)",
ylab = "Weight (pounds)",
pch = 19, col = "blue")
plot(Q2data$yield, Q2datarainfall,
main = "Weight vs Height of American Women (30–39)",
xlab = "Height (inches)",
ylab = "Weight (pounds)",
pch = 19, col = "blue")
plot(Q2data$yield, Q2data$rainfall,
main = "Weight vs Height of American Women (30–39)",
xlab = "Height (inches)",
ylab = "Weight (pounds)",
pch = 19, col = "blue")
head(Q2data$yield)
head(Q2data$rainfall)
plot(Q2data$rainfall, Q2data$yield,
main = "Weight vs Height of American Women (30–39)",
xlab = "Height (inches)",
ylab = "Weight (pounds)",
pch = 19, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Weight vs Height of American Women (30–39)",
xlab = "Rainfall",
ylab = "Yield",
pch = 19, col = "blue")
Q2data <- read.csv("XM225F_q2.csv")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 19, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 16, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 2, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 15, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 17, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 1, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 0, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 1, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 1, col = "lightblue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 1, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 19, col = "blue")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield", col = "blue")
pch = 19,
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 19, col = "blue")
abline(model_1, col = "red", lwd = 2)
summary(model_1)
par(mfrow = c(2, 2))
plot(model_1)
par(mfrow = c(1, 1))
shapiro.test(residuals(model_1))
library(car)
ncvTest(model)
ncvTest(model_1)
model_2 <- lm(yield ~ rainfall * fertilizer, data = Q2data)
summary(model_2)
summary(model_2)
drop1(model_2, test = "F")
summary(model_2)
drop1(model_2, test = "F")
summary(model_2)
vif(model_2)
data_3 <- read.csv("XM225F_q3.csv")
summary(model_2)
drop1(model_2)
drop1(model_2, test = "f")
drop1(model_2, test = "F")
summary(model_2)
model_3 <- update(model_2, .~., -fertilizer)
summary(model_3)
model_3 <- update(model_2, .~., -fertilizerOrganic)
summary(model_3)
summary(model_2)
model_2 <- lm(yield ~ rainfall * fertilizer, data = Q2data) #rainfall * fertilizer is basically both + interaction
summary(model_2)
str(Q2data)
model_2 <- lm(yield ~ rainfall * fertilizer, data = Q2data) #rainfall * fertilizer is basically both + interaction
summary(model_2)
model_3 <- update(model_2, .~., - fertilizerOrganic)
summary(model_3)
model_3 <- update(model_2, .~. - fertilizerOrganic)
summary(model_3)
model_3 <- update(model_2, .~. - fertilizer)
summary(model_3)
summary(model_2)
summary(model_2)
summary(model_3)
summary(model_2)
summary(model_3)
summary(model_2)
summary(model_2)
summary(model_3)
summary(model_2)
summary(model_3)
par(mfrow = c(2, 2))
plot(model_3)
par(mfrow = c(1, 1))
shapiro.test(residuals(model_2))
library(car)
ncvTest(model_2)
summary(model_3)
summary(model_3)
summary(model_2)
summary(model_3)
predict(model_3, newdata = data.frame(rainfall = 770, fertilizer = "Organic"), interval = "c", level = 0.98)
predict(model_3, newdata = data.frame(rainfall = 770, fertilizer = "Orgsanic"), interval = "c", level = 0.98)
predict(model_3, newdata = data.frame(rainfall = 770, fertilizer = "Organic"), interval = "c", level = 0.98)
predict(model_3, newdata = data.frame(rainfall = 770, fertilizer = "Chemical"), interval = "c", level = 0.98)
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[q2_data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[Q2data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[Q2data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
fertilizer
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[Q2data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
plot(Q2data$rainfall, Q2data$yield,
main = "Yield vs Rainfall",
xlab = "Rainfall",
ylab = "Yield",
pch = 19, col = "blue") # do a scatterplot of rainfall vs yield.
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red"),
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[Q2data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
model_1 <- lm(yield ~ rainfall, data = Q2data)
str(Q2data)
Q2data <- read.csv("XM225F_q2.csv")
head(Q2data)
str(Q2data)
Q2data$fertilizer  <- as.factor(Q2data$fertilizer)
str(Q2data)
#plot of yield ~ rainfall with fertilizer in question too
plot(Q2data$rainfall, Q2data$yield,
col = c("blue", "red")[Q2data$fertilizer],
xlab = "Age",
ylab = "Duration",
main = "Scatterplot of Duration vs Age")
shapiro.test(residuals(model_2))
ncvTest(model_2)
shapiro.test(residuals(model_3))
ncvTest(model_3)
summary(model_3)
abline(a = coef(model_3)[1], b = coef(model_3)[2], col = "blue", lwd = 2)
abline(a = coef(model_3)[1] + coef(model_3)[3],
b = coef(model_3)[2],
col = "red", lwd = 2)
+ coef(model_3)[4]
abline(a = coef(model_3)[1],
b = coef(model_3)[2] + coef(model_3)[3],
col = "red", lwd = 2)
abline(a = coef(model_3)[1], b = coef(model_3)[2], col = "blue", lwd = 2)
legend("topleft",
legend = c("Chemical", "Organic"),
col = c("blue", "red"),
lwd = 2)
str(Q3data)
Q3data <- read.csv("XM225F_q3.csv")
str(Q3data)
scatterplotMatrix(Q3data)
library(corrplot)
cor_1 <- cor(q1_data)
cor_1 <- cor(Q3data)
corrplot.mixed(cor_1)
scatterplotMatrix(Q3data)
corrplot.mixed(cor_1)
full_model <- lm(los ~ age + bmi + sbp + dbp + hr + cmb + p.adm + severity, data = Q3data)
summary(full_model)
vif(full_model) # print out the vif of the model
#we see that the highest value is dbp and is > 2, so we get rid of it and check again.
mod1 <- update(full_model, .~. - dbp)
vif(mod1)
vif(mod1)
drop1(mod1, test = "F")
mod2 <- update(mod1, .~. -hr)
drop1(mod2, test = "F")
mod3 <- update(mod2, .~. -sbp) #here we drop sbp, which has a value of 0.22 > 0.1
drop1(mod3, test = "F")
#Since all values are over a_crit, we got our minimally adequate model.
summary(mod3)
library(MASS)
aic_model <- stepAIC(full_model)
summary(aic_model)
#Since all values are over a_crit, we got our minimally adequate model.
summary(mod3)
summary(aic_model)
#Since all values are over a_crit, we got our minimally adequate model.
summary(mod3)
summary(mod3)
predict_data <- data.frame(age = 46, bmi = 30.1, sbp = 132, dbp = 93,
hr = 77, cmb = 3, p.adm = 1, severity = 2.1)
predict(mod3, newdata = predict_data, interval = "c", level = 0.98)
par(mfrow = c(2, 2))
plot(mod3)
par(mfrow = c(1, 1))
ncvTest(mod3)
shapiro.test(residuals(mod3))
ncvTest(mod3)

data <- read.csv("iguanodon.csv")
head(data)
str(data)
data <- read.csv("iguanodon.csv")
head(data)
str(data)
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue")
model <- lm(bite_st ~ head_length, data = data)
abline(model, col = "red", lwd = 2)
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue",
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(65, max(data$bite_st) + 12))
abline(model, col = "red", lwd = 2)
summary(model)
predict(model,
newdata = data.frame(head_length = 90),
interval = "prediction",
level = 0.98)
par(mfrow = c(2, 2))
plot(model)
par(mfrow = c(1, 1))
hist(residuals(model), breaks=10,
main="Histogram of Residuals",
xlab="Residuals")
hist(residuals(model), breaks=10,
main="Histogram of Residuals",
xlab="Residuals")
lines(density(residuals(model)),
col = "blue", lwd = 2)
curve(dnorm(x, mean = mean(residuals(model)), sd = sd(residuals(model))),
add = TRUE,
col = "red", lwd = 2)
hist(residuals(model), breaks=10,
freq = FALSE,
main="Histogram of Residuals",
xlab="Residuals")
lines(density(residuals(model)),
col = "blue", lwd = 2)
curve(dnorm(x, mean = mean(residuals(model)), sd = sd(residuals(model))),
add = TRUE,
col = "red", lwd = 2)
legend("topright",
legend = c("Density Curve", "Normal Curve"),
col = c("blue", "red"),
lwd = 2)
data <- read.csv("iguanodon.csv")
head(data)
str(data)
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue")
model <- lm(bite_st ~ head_length, data = data)
abline(model, col = "red", lwd = 2)
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue",
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(65, max(data$bite_st) + 12))
abline(model, col = "red", lwd = 2)
hist(residuals(model), breaks=10,
freq = FALSE,
main="Histogram of Residuals",
xlab="Residuals")
lines(density(residuals(model)),
col = "blue", lwd = 2)
curve(dnorm(x, mean = mean(residuals(model)), sd = sd(residuals(model))),
add = TRUE,
col = "red", lwd = 2)
legend("topright",
legend = c("Density Curve", "Normal Curve"),
col = c("blue", "red"),
lwd = 2)
shapiro.test(residuals(model))
library(car)
ncvTest(model)
str(data)
head(data)
model_full <- lm(bite_st ~ head_length * species, data = data)
summary(model_full)
model_all <- lm(bite_st ~ length + weight + width + height +
leg_length + arm_length + head_length + species,
data = data)
summary(model_all)
,
model_red1 <- update(model_all, . ~ . - species)
anova(model_all, model_red1)
summary(model_red1)
model_red2 <- update(model_red1, . ~ . - length)
model_red2 <- update(model_red1, . ~ . - length)
anova(model_red1, model_red2)
summary(model_red2)
model_red3 <- update(model_red2, . ~ . - weight)
anova(model_red2, model_red3)
summary(model_red3)
model_red4 <- update(model_red3, . ~ . - width)
anova(model_red3, model_red4)
summary(model_red4)
model_red5 <- update(model_red4, . ~ . - arm_length)
anova(model_red4, model_red5)
summary(model_red5)
model_red6 <- update(model_red5, . ~ . - leg_length)
anova(model_red5, model_red6)
summary(model_red6)
model_red7 <- update(model_red6, . ~ . - head_length)
anova(model_red6, model_red7)
summary(model_red7)
model_full <- lm(bite_st ~ head_length * species, data = data)
summary(model_full)
model_red7 <- update(model_red6, . ~ . - head_length)
anova(model_red6, model_red7)
summary(model_red7)
abline(model_full, col = "red", lwd = 2)
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue",
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(65, max(data$bite_st) + 12))
abline(model, col = "red", lwd = 2)
abline(model_full, col = "red", lwd = 2)
summary(model)
abline(model_red7, col = "green", lwd = 2)
abline(model_red7, col = "green", lwd = 2)
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue",
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(20, max(data$bite_st) + 12))
abline(model, col = "red", lwd = 2)
abline(model_full, col = "blue", lwd = 2)
abline(model_red7, col = "green", lwd = 2)
plot(data$head_length, data$bite_st, col=data$species)
plot(data$head_length, data$bite_st)
abline(
a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2
)
abline(
a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2
)
plot(data$head_length, data$bite_st, col=data$species)
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"),
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(20, max(data$bite_st) + 12))
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"),
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(min(data$bite_st) - 2, max(data$bite_st) + 12))
plot(data$head_length, data$bite_st,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"),
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(min(data$bite_st) - 2, max(data$bite_st) + 2))
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"),
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(min(data$bite_st) - 2, max(data$bite_st) + 2))
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Bite Strength vs Head Length",
pch = 19, col = "blue")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"),
xlim = c(min(data$head_length) - 2, max(data$head_length) + 2),
ylim = c(min(data$bite_st) - 2, max(data$bite_st) + 2))
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "darkgreen", lwd = 2)
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "purple", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
plot(data$height, data$bite_st,
xlab = "Height",
ylab = "Bite Strength",
main = "Model_red7 (Height)",
pch = 19,
col = "blue",
xlim = c(min(data$height) - 2, max(data$height) + 2),
ylim = c(20, max(data$bite_st) + 12))
plot(data$height, data$bite_st,
xlab = "Height",
ylab = "Bite Strength",
main = "Model_red7 (Height)",
pch = 19,
col = "blue")
abline(model_red7, col = "red", lwd = 2)
legend("topleft",
legend = c("Species A", "Species B", "Simple Model",
"Full Model (A)", "Full Model (B)"),
col = c("blue", "red", "black", "darkgreen", "purple"),
lwd = 2, bty = "n")
legend("topleft",
legend = c("Species A line", "Species B line"),
col = c("blue", "red",),
lwd = 2, bty = "n")
legend("topleft",
legend = c("Species A line", "Species B line"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("topleft",
legend = c("Species A line", "Species B line"),
col = c("blue", "red"),
lwd = 2, bty = "n")
legend("left",
legend = c("Species A line", "Species B line"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Species A line", "Species B line"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(data$height, data$bite_st,
xlab = "Height",
ylab = "Bite Strength",
main = "Model_red7 (Height)",
pch = 19,
col = "blue")
abline(model_red7, col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(data$height, data$bite_st,
xlab = "Height",
ylab = "Bite Strength",
main = "Model_red7 (Height)",
pch = 19,
col = "blue")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "n")
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 1, bty = "n")
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "n")
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "r")
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2, bty = "n")
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2)
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2)
shapiro.test(residuals(model_red7))
ncvTest(model_red7)
shapiro.test(residuals(model_full))
ncvTest(residuals(model_full))
ncvTest(model_full)
shapiro.test(residuals(model_full))
ncvTest(model_full)
model_full <- lm(bite_st ~ head_length * species, data = data)
summary(model_full)
predict(model_full,
newdata = data.frame(head_length = 90),
interval = "prediction",
level = 0.98)
str(model_full)
predict(model_full,
newdata = data.frame(head_length = 90, species = factor("A", levels = c("A", "B"))),
interval = "prediction",
level = 0.98)
predict(model_full,
newdata = data.frame(head_length = 90, species = factor("A", levels = c("A", "B"))),
interval = "prediction",
level = 0.98)
predict(model_full,
newdata = data.frame(head_length = 90, species = factor("B", levels = c("A", "B"))),
interval = "prediction",
level = 0.98)
predict(model,
newdata = data.frame(head_length = 90),
interval = "prediction",
level = 0.98)
summary(model_full)
shapiro.test(residuals(model_full))
ncvTest(model_full)
summary(model_all)
anova(model_all, model_red1)
summary(model_all)
model_red1 <- update(model_all, . ~ . - species)
anova(model_all, model_red1)
summary(model_red1)
anova(model_red1, model_red2)
summary(model_red2)
summary(model_red1)
summary(model_red2)
model_red3 <- update(model_red2, . ~ . - weight)
anova(model_red2, model_red3)
anova(model_red3, model_red4)
anova(model_red2, model_red3)
summary(model_red3)
model_red4 <- update(model_red3, . ~ . - width)
anova(model_red3, model_red4)
model_red5 <- update(model_red4, . ~ . - arm_length)
summary(model_red4)
anova(model_red4, model_red5)
summary(model_red5)
anova(model_red5, model_red6)
summary(model_red6)
anova(model_red6, model_red7)
summary(model_red7)
shapiro.test(residuals(model_red7))
ncvTest(model_red7)
#doing the all thing.
model_all <- lm(bite_st ~ length + weight + width + height +
leg_length + arm_length + head_length + species,
data = data)
summary(model_all)
model_red1 <- update(model_all, . ~ . - species)
anova(model_all, model_red1)
summary(model_red1)
model_red2 <- update(model_red1, . ~ . - length)
anova(model_red1, model_red2)
summary(model_red2)
model_red3 <- update(model_red2, . ~ . - weight)
anova(model_red2, model_red3)
summary(model_red3)
model_red4 <- update(model_red3, . ~ . - width)
anova(model_red3, model_red4)
summary(model_red4)
model_red5 <- update(model_red4, . ~ . - arm_length)
anova(model_red4, model_red5)
summary(model_red5)
model_red6 <- update(model_red5, . ~ . - leg_length)
anova(model_red5, model_red6)
summary(model_red6)
model_red7 <- update(model_red6, . ~ . - head_length)
anova(model_red6, model_red7)
summary(model_red7)
model_red7 <- update(model_red6, . ~ . - head_length)
anova(model_red6, model_red7)
summary(model_red7)
summary(model_full)
summary(model_red7)
summary(model)
summary(model_full)
predict(model_full,
newdata = data.frame(head_length = 90, species = factor("A", levels = c("A", "B"))),
interval = "prediction",
level = 0.98)
predict(model_full,
newdata = data.frame(head_length = 90, species = factor("B", levels = c("A", "B"))),
interval = "prediction",
level = 0.98)
plot(bite_st ~ head_length, data = data,
xlab = "Head Length (cm)",
ylab = "Bite Strength",
main = "Models on Head Length",
pch = 19,
col = ifelse(data$species == "A", "blue", "red"))
abline(a = coef(model_full)["(Intercept)"],
b = coef(model_full)["head_length"],
col = "blue", lwd = 2)
abline(a = coef(model_full)["(Intercept)"] + coef(model_full)["speciesB"],
b = coef(model_full)["head_length"] + coef(model_full)["head_length:speciesB"],
col = "red", lwd = 2)
legend("left",
legend = c("Full model (Species A)", "Full Model (Species B)"),
col = c("blue", "red"),
lwd = 2)
plot(data$height, data$bite_st,
xlab = "Height",
ylab = "Bite Strength",
main = "Model_red7 (Height)",
pch = 19,
col = "blue")
abline(model_red7, col = "red", lwd = 2)
